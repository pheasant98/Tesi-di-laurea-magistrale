\chapter{Codice in R}
\section{extractRowsAway}
\label{sez:raccolta}
Codice della funzione per la raccolta delle partite giocate fuori casa dalla squadra indicata nella variabile \texttt{Team}.

\begin{lstlisting}[language=R, caption={Codice di adattamento dataset per il trasferimento dati.}, captionpos=b, label=code:a1]
extractRowsAway <-function(){
	k <- 1
	z <- 1
	for(i in 1:nrow(AdjserieA)){
		if(AdjserieA$AtHome[i] == TRUE){
			for(j in 1:nrow(AdjserieA)){
				if((AdjserieA$Team[j] == AdjserieA$Vs[i]) && (AdjserieA$Team[i] == AdjserieA$Vs[j]) && (AdjserieA$AtHome[j] == FALSE)){
					PossVs[k] <<- AdjserieA$Poss[j]
					ShVs[k] <<- AdjserieA$Sh[j]
					ShTVs[k] <<- AdjserieA$SoT[j]
					G.ShVs[k] <<- AdjserieA$`G/Sh`[j]
					SavesVs[k] <<- AdjserieA$Saves[j]
					PAttVs[k] <<- AdjserieA$PAtt[j]
					PCmp.Vs[k] <<- AdjserieA$`PCmp%`[j]
					SPAttVs[k] <<- AdjserieA$SPAtt[j]
					SPCmp.Vs[k] <<- AdjserieA$`SPCmp%`[j]
					MPAttVs[k] <<- AdjserieA$MPAtt[j]
					MPCmp.Vs[k] <<- AdjserieA$`MPCmp%`[j]
					LPAttVs[k] <<- AdjserieA$LPAtt[j]
					LPCmp.Vs[k] <<- AdjserieA$`LPCmp%`[j]
					ToDefPenVs[k] <<- AdjserieA$ToDefPen[j]
					ToDef3rdVs[k] <<- AdjserieA$ToDef3rd[j]
					ToMid3rdVs[k] <<- AdjserieA$ToMid3rd[j]
					ToAtt3rdVs[k] <<- AdjserieA$ToAtt3rd[j]
					ToAttPenVs[k] <<- AdjserieA$ToAttPen[j]
					ToDistVs[k] <<- AdjserieA$TotDist[j]
					FlsVs[k] <<- AdjserieA$Fls[j]
					FldVs[k] <<- AdjserieA$Fld[j]
					OffVs[k] <<- AdjserieA$Off[j]
					CrsVs[k] <<- AdjserieA$Crs[j]
					IntVs[k] <<- AdjserieA$Int[j]
					TklWinVs[k] <<- AdjserieA$TklWin[j]
					RecovVs[k] <<- AdjserieA$Recov[j]
					GFVs[k] <<- AdjserieA$GF[j]
					GAVs[k] <<- AdjserieA$GA[j]
					k <- k + 1  
				}      
			}
		} else{
			del[z] <<- i
			z <- z + 1
		}
	}
}
\end{lstlisting}

\section{createYFull}
\label{sez:y3}
Codice della funzione per la creazione della variabile \texttt{Y3}.

\begin{lstlisting}[language=R, caption={Codice per la creazione della variabile Y3.}, captionpos=b, label=code:a4]
createYFull <- function(SerieA){
	for(i in 1:38){
		for(y in 1:10){
			for(z in 1:nrow(SerieA)){
				if((paste(str1, i) == SerieA$Round[z]) && (SerieA$AtHome[z] == TRUE )  && (first.time[z] == TRUE)){
					if(SerieA$Res[z] == -1)
					{
						response[w] <<- 3
					}
					else{
						if(SerieA$Res[z] == 0){
							response[w] <<- 2
						}
						else{
							response[w] <<- SerieA$Res[z]
						}
						
					}              
					switch(
					SerieA$Team[z],
					"Atalanta"  =  first.object[w] <<- 1,
					"Bologna"  =  first.object[w] <<- 2,       
					"Cagliari"  =  first.object[w] <<- 3,      
					"Empoli"  =  first.object[w] <<- 4,        
					"Fiorentina"  =  first.object[w] <<- 5,    
					"Genoa"  =  first.object[w] <<- 6,         
					"Hellas Verona"  =  first.object[w] <<- 7, 
					"Inter"  =  first.object[w] <<- 8,        
					"Juventus"  =  first.object[w] <<- 9,     
					"Lazio"  =  first.object[w] <<- 10,         
					"Milan"  =  first.object[w] <<- 11,         
					"Napoli"  =  first.object[w] <<- 12,        
					"Roma"  =  first.object[w] <<- 13,          
					"Salernitana"  =  first.object[w] <<- 14,   
					"Sampdoria"  =  first.object[w] <<- 15,     
					"Sassuolo"  =  first.object[w] <<- 16,     
					"Spezia"  =  first.object[w] <<- 17,        
					"Torino"  =  first.object[w] <<- 18,        
					"Udinese"  =  first.object[w] <<- 19,       
					"Venezia"  =  first.object[w] <<- 20,      
					)
					switch(
					SerieA$Vs[z],
					"Atalanta"  =  second.object[w] <<- 1,
					"Bologna"  =  second.object[w] <<- 2,       
					"Cagliari"  =  second.object[w] <<- 3,      
					"Empoli"  =  second.object[w] <<- 4,        
					"Fiorentina"  =  second.object[w] <<- 5,    
					"Genoa"  =  second.object[w] <<- 6,         
					"Hellas Verona"  =  second.object[w] <<- 7, 
					"Inter"  =  second.object[w] <<- 8,        
					"Juventus"  =  second.object[w] <<- 9,     
					"Lazio"  =  second.object[w] <<- 10,         
					"Milan"  =  second.object[w] <<- 11,         
					"Napoli"  =  second.object[w] <<- 12,        
					"Roma"  =  second.object[w] <<- 13,          
					"Salernitana"  =  second.object[w] <<- 14,   
					"Sampdoria"  =  second.object[w] <<- 15,     
					"Sassuolo"  =  second.object[w] <<- 16,     
					"Spezia"  =  second.object[w] <<- 17,        
					"Torino"  =  second.object[w] <<- 18,        
					"Udinese"  =  second.object[w] <<- 19,       
					"Venezia"  =  second.object[w] <<- 20,      
					)
					
					subject[w] <<- paste(str1, i)
					with.order[w] <<- TRUE
					first.time[z] <- FALSE
					w <- w + 1
					break
				}
			}
		}
	}
}
\end{lstlisting}

\section{extractData}
\label{sez:Z1.1}
Codice della funzione per estrarre le informazioni di una variabile.

\begin{lstlisting}[language=R, caption={Codice per estrarre le informazioni di una variabile.}, captionpos=b, label=code:a5]
extractData <-function(cov){
	for(i in 1:nrow(SerieA)){
		switch(
			SerieA$Team[i],
			"Atalanta"  =  {ata[it[1]] <<- SerieA[[cov]][i]
				it[1] <- it[1] + 1                      
			},
			"Bologna"  =  {bol[it[2]] <<- SerieA[[cov]][i]
				it[2] <- it[2] + 1
			},       
			"Cagliari"  =  {cag[it[3]] <<- SerieA[[cov]][i]
				it[3] <- it[3] + 1
			},      
			"Empoli"  =  {emp[it[4]] <<- SerieA[[cov]][i]
				it[4] <- it[4] + 1
			},      
			"Fiorentina"  =  {fio[it[5]] <<- SerieA[[cov]][i]
				it[5] <- it[5] + 1
			},   
			"Genoa"  =  {gen[it[6]] <<- SerieA[[cov]][i]
				it[6] <- it[6] + 1
			},        
			"Hellas Verona"  =  {ver[it[7]] <<- SerieA[[cov]][i]
				it[7] <- it[7] + 1
			},
			"Inter"  =  {int[it[8]] <<- SerieA[[cov]][i]
				it[8] <- it[8] + 1
			},       
			"Juventus"  =  {juv[it[9]] <<- SerieA[[cov]][i]
				it[9] <- it[9] + 1
			},     
			"Lazio"  =  {laz[it[10]] <<- SerieA[[cov]][i]
				it[10] <- it[10] + 1
			},         
			"Milan"  =  {mil[it[11]] <<- SerieA[[cov]][i]
				it[11] <- it[11] + 1
			},         
			"Napoli"  =  {nap[it[12]] <<- SerieA[[cov]][i]
				it[12] <- it[12] + 1
			},        
			"Roma"  =  {rom[it[13]] <<- SerieA[[cov]][i]
				it[13] <- it[13] + 1
			},          
			"Salernitana"  =  {sal[it[14]] <<- SerieA[[cov]][i]
				it[14] <- it[14] + 1
			},   
			"Sampdoria"  =  {sam[it[15]] <<- SerieA[[cov]][i]
				it[15] <- it[15] + 1
			},     
			"Sassuolo"  =  {sas[it[16]] <<- SerieA[[cov]][i]
				it[16] <- it[16] + 1
			},     
			"Spezia"  =  {spe[it[17]] <<- SerieA[[cov]][i]
				it[17] <- it[17] + 1
			},        
			"Torino"  =  {tor[it[18]] <<- SerieA[[cov]][i]
				it[18] <- it[18] + 1
			},       
			"Udinese"  = {udi[it[19]] <<- SerieA[[cov]][i]
				it[19] <- it[19] + 1
			},       
			"Venezia"  =  {ven[it[20]] <<- SerieA[[cov]][i]
				it[20] <- it[20] + 1
			},     
		)
	}
}
\end{lstlisting}

\section{extractAll}
\label{sez:Z1.2}
Codice della funzione per estrarre le informazioni di tutte le variabili.

\begin{lstlisting}[language=R, caption={Codice per estrarre le informazioni di tutte le variabili.}, captionpos=b, label=code:a6]
extractAll <- function(covs, row, teams, n = 20, m = 38){
	clear()
	num <- 20
	isFirst = TRUE
	tab <-c()
	for(z in 1:length(covs)){
		extractData(covs[z])
		if(isFirst){
			tab <- matrix(cbind(ata,bol,cag,emp,fio,gen,ver,int,juv,laz,mil,nap,rom,sal,sam,sas,spe,tor,udi,ven), nrow = m, ncol = num)
			isFirst = FALSE
		}
		else{
			tab <- matrix(cbind(tab, ata,bol,cag,emp,fio,gen,ver,int,juv,laz,mil,nap,rom,sal,sam,sas,spe,tor,udi,ven), nrow = m, ncol = num)
		}
		refresh()
		num <- num + n 		
	}
	col <- colLabel(teams, covs)  
	num2 <- num - n
	dimnames(tab) <- list(row[1:m], col[1:num2])
	return(tab)
}
\end{lstlisting}

\section{colLabel}
\label{sez:Z1.3}
Codice della funzione per la creazione delle etichette delle colonne.

\begin{lstlisting}[language=R, caption={Codice per la creazione delle etichette delle colonne.}, captionpos=b, label=code:a7]
colLabel <- function(teams, cov){
	nameCov <- c()
	z <- 1
	for(i in 1:length(cov)){
		for(y in 1:length(teams)){
			nameCov[z] <- paste(cov[i], teams[y], sep=".")
			z <- z + 1
		}
	}
	return(nameCov)
}

\end{lstlisting}

\section{rowLabel}
\label{sez:Z1.4}
Codice della funzione per la creazione delle etichette delle righe.

\begin{lstlisting}[language=R, caption={Codice per la creazione delle etichette delle righe.}, captionpos=b, label=code:a8]
rowLabel <- function(str, n){
	nameRows <- c()
	for(i in 1:n){
		nameRows[i] <- paste(str, i)
	}
	return(nameRows)
}

\end{lstlisting}

\section{createTable}
Codice per la creazione del dataset utilizzabile con i metodi di machine learning.
\begin{lstlisting}[language=Python, caption={Codice per la creazione del dataset utilizabile con i metodi di machine learning.}, captionpos=b, label=code:a9]
def createTable(df, dfM): 
	for i in range(0, df.shape[0], 1):
		if df.AtHome[i] == True: 
			for j in range(0, df.shape[0], 1): 
				if df.Team[j] == df.Vs[i] and df.Team[i] == df.Vs[j] and df.AtHome[j] == False:
					dfM2 = pd.DataFrame({'Date': [df.Date[i]],
										'Round': [df.Round[i]],
										'AtHome': [df.AtHome[i]],
										'Result': [df.Res[i]],
										'G_Home': [df.GF[i]],
										'G_Away': [df.GA[i]],
										'Home_Team': [df.Team[i]],
										'Away_Team': [df.Vs[i]],
										'Home_Poss': [df.Poss[i]],
										'Home_Sh': [df.Sh[i]],
										'Home_SoT': [df.SoT[i]],
										'Home_G/Sh': [df['G/Sh'][i]],
										'Home_Saves': [df.Saves[i]],
										'Home_PAtt': [df.PAtt[i]],
										'Home_PCmp%': [df['PCmp%'][i]],
										'Home_SPAtt': [df.SPAtt[i]],
										'Home_SPCmp%': [df['SPCmp%'][i]],
										'Home_MPAtt': [df.MPAtt[i]],
										'Home_MPCmp%': [df['MPCmp%'][i]],
										'Home_LPAtt': [df.LPAtt[i]],
										'Home_LPCmp%': [df['LPCmp%'][i]],
										'Home_ToDefPen': [df.ToDefPen[i]],
										'Home_ToDef3rd': [df.ToDef3rd[i]],
										'Home_ToMid3rd': [df.ToMid3rd[i]],
										'Home_ToAtt3rd': [df.ToAtt3rd[i]],
										'Home_ToAttPen': [df.ToAttPen[i]],
										'Home_TotDist': [df.TotDist[i]],
										'Home_Fls': [df.Fls[j]],
										'Home_Fld': [df.Fld[i]],
										'Home_Off': [df.Off[i]],
										'Home_Crs': [df.Crs[j]],
										'Home_Int': [df.Int[j]],
										'Home_TklWin': [df.TklWin[i]],
										'Home_Recov': [df.Recov[i]],
										'Away_Poss': [df.Poss[j]],
										'Away_Sh': [df.Sh[j]],
										'Away_SoT': [df.SoT[j]],
										'Away_G/Sh': [df['G/Sh'][j]],
										'Away_Saves': [df.Saves[j]],
										'Away_PAtt': [df.PAtt[j]],
										'Away_PCmp%': [df['PCmp%'][j]],
										'Away_SPAtt': [df.SPAtt[j]],
										'Away_SPCmp%': [df['SPCmp%'][j]],
										'Away_MPAtt': [df.MPAtt[j]],
										'Away_MPCmp%': [df['MPCmp%'][j]],
										'Away_LPAtt': [df.LPAtt[j]],
										'Away_LPCmp%': [df['LPCmp%'][j]],
										'Away_ToDefPen': [df.ToDefPen[j]],
										'Away_ToDef3rd': [df.ToDef3rd[j]],
										'Away_ToMid3rd': [df.ToMid3rd[j]],
										'Away_ToAtt3rd': [df.ToAtt3rd[j]],
										'Away_ToAttPen': [df.ToAttPen[j]],
										'Away_TotDist': [df.TotDist[j]],
										'Away_Fls': [df.Fls[j]],
										'Away_Fld': [df.Fld[j]],
										'Away_Off': [df.Off[j]],
										'Away_Crs': [df.Crs[j]],
										'Away_Int': [df.Int[j]],
										'Away_TklWin': [df.TklWin[j]],
										'Away_Recov': [df.Recov[j]]})
					dfM = dfM.append(dfM2, ignore_index=True) 
	return dfM
	
\end{lstlisting}